{% extends 'main/base.html' %}

{% block title %}Мои аллергены{% endblock %}

{% block content %}
<section class="card" style="max-width: 860px; margin: 0 auto;">
    <div class="inline-actions" style="justify-content: space-between; align-items: baseline;">
        <div>
            <p class="pill">Персональные</p>
            <h2 class="title" style="margin: 6px 0 0;">Добавить свой аллерген</h2>
            <p class="muted" style="margin-top: 6px;">Создавайте личные аллергены, чтобы отмечать их в блюдах.</p>
        </div>
        <a class="back-link" href="{% url 'home' %}">← В основное меню</a>
    </div>

    <form method="post" style="margin-top: 16px;">
        {% csrf_token %}
        {{ form.as_p }}
        <button class="btn btn-primary" type="submit">Добавить мой аллерген</button>
    </form>

    <h3 class="section-title">Ваши аллергены</h3>
    <ul class="chip-list">
        {% for a in allergens %}
            <li style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                <span>{{ a.name }}</span>
                <span class="badge">{{ a.created_at|date:"d.m.Y" }}</span>
                <span style="margin-left: auto; display: inline-flex; gap: 6px;">
                    <a class="btn btn-ghost" href="{% url 'allergen_edit' a.pk %}">Изменить</a>
                    <form method="post" action="{% url 'allergen_delete' a.pk %}" style="margin: 0;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger" onclick="return confirm('Удалить аллерген «{{ a.name }}»?');">Удалить</button>
                    </form>
                </span>
            </li>
        {% empty %}
            <li class="muted">У вас пока нет своих аллергенов</li>
        {% endfor %}
    </ul>

</section>
{% endblock %}